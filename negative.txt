private static void reorderElements(Document doc, String parentXPath, String[] tagOrder) throws Exception {
    XPath xpath = XPathFactory.newInstance().newXPath();
    Node parentNode = (Node) xpath.evaluate(parentXPath, doc, XPathConstants.NODE);
    if (parentNode == null) {
        System.out.println("Invalid parent XPath: " + parentXPath);
        return;
    }

    // Create a map of child elements by tag name
    Map<String, Element> elementMap = new LinkedHashMap<>();
    NodeList children = parentNode.getChildNodes();
    for (int i = 0; i < children.getLength(); i++) {
        Node child = children.item(i);
        if (child.getNodeType() == Node.ELEMENT_NODE) {
            elementMap.put(child.getNodeName(), (Element) child);
        }
    }

    // Remove all elements first
    for (Element elem : elementMap.values()) {
        parentNode.removeChild(elem);
    }

    // Add them back in wrong order
    for (String tag : tagOrder) {
        Element el = elementMap.get(tag);
        if (el != null) {
            parentNode.appendChild(el);
        }
    }
}
